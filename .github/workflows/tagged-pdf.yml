name: Resume to tagged PDF
on:
  workflow_dispatch:  # Allows manual triggering

jobs:
  generate-pdf:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Generate PDF from DocRaptor
        run: |
          curl https://${{ secrets.DOCRAPTOR_KEY }}@api.docraptor.com/docs \
          --fail --silent --show-error \
          --header "Content-Type:application/json" \
          --data '{
            "doc": {
              "test": true,
              "document_url": "https://jasonmorris.com/resume",
              "type": "pdf",
              "prince_options": { "profile": "PDF/UA-1", "tagged-pdf": true }
            }
          }' > jason-morris-resume.pdf

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          commit-message: Update resume PDF
          title: 'Update resume PDF'
          body: |
            Automated PDF generation from jasonmorris.com/resume
            - Generated using DocRaptor API (Prince XML)
            - PDF/UA-1 compliant tagged PDF, passes PAC 2024
          branch: update-resume-pdf
          delete-branch: true
          base: main
