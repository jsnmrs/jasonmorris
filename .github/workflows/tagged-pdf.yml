name: Resume to tagged PDF
on:
  workflow_dispatch:  # Allows manual triggering

jobs:
  generate-pdf:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Generate PDF from DocRaptor
        run: |
          curl https://${{ secrets.DOCRAPTOR_KEY }}@api.docraptor.com/docs \
          --fail --silent --show-error \
          --header "Content-Type:application/json" \
          --data '{
            "doc": {
              "test": true,
              "document_url": "https://jasonmorris.com/resume",
              "type": "pdf",
              "prince_options": { "profile": "PDF/UA-1", "tagged-pdf": true }
            }
          }' > jason-morris-resume.pdf

      - name: Commit and push if PDF changed
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add jason-morris-resume.pdf
          git diff --staged --quiet || (git commit -m "Update resume PDF" && git push)
